<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="cricket.css">
    <title>Cricket Game using object</title>
  </head>
  <body>
    <div id="container">
      <div>
      <h1 class="heading">Bat Ball Stump Game</h1>

      <button
        onclick="
          let computerChoice = generateComputerChoice();
          let resultMsg = getResultMsg('Bat', computerChoice);

          if (resultMsg === 'You have Won') {
            score.win += 1;
          } else if (resultMsg === `It's a Tie`) {
            score.tie += 1;
          } else if (resultMsg === 'Computer has Won') {
            score.lost += 1;
          }

          showResult('Bat', computerChoice, resultMsg);
        "
      ><img src="images/bat.png" alt="bat-image" class="choice-img"></button>

      <button
        onclick="
          computerChoice = generateComputerChoice();
          resultMsg = getResultMsg('Ball', computerChoice);

          if (resultMsg === 'You have Won') {
            score.win += 1;
          } else if (resultMsg === `It's a Tie`) {
            score.tie += 1;
          } else if (resultMsg === 'Computer has Won') {
            score.lost += 1;
          }

          showResult('Ball', computerChoice, resultMsg);
        "
      ><img src="images/ball.png" alt="ball-image" class="choice-img"></button>

      <button
        onclick="
          computerChoice = generateComputerChoice();
          resultMsg = getResultMsg('Stump', computerChoice);

          if (resultMsg === 'You have Won') {
            score.win += 1;
          } else if (resultMsg === `It's a Tie`) {
            score.tie += 1;
          } else if (resultMsg === 'Computer has Won') {
            score.lost += 1;
          }

          showResult('Stump', computerChoice, resultMsg);
        "
      ><img src="images/stump.png" alt="stump-image" class="choice-img"></button>
    </div>

        <div id="result-container">
          <h1>Result will show here</h1>
          <h3 id="user-move"></h3>
          <h3 id="computer-move"></h3>
          <h3 id="result"></h3>
          <h3 id="score"></h3>
        </div>

        <button class="reset" onclick='localStorage.clear()
          resetScore();
        '>Reset</button>
    </div>

    <script> 
      let scoreStr = localStorage.getItem('score');
      let score;
      resetScore(scoreStr);

      function resetScore(scoreStr){
        score = scoreStr ? JSON.parse(scoreStr) :{
        win: 0, 
        lost: 0,
        tie: 0,
      };

      score.displayScore = function (userMove, computerMove, resultMsg){
        return `\nWon: ${score.win}, Lost: ${score.lost}, Tie: ${score.tie}` 
      };

      showResult();

      }

      function generateComputerChoice() {
        let randomNumber = Math.random() * 3;
        let computerChoice = '';

        if (randomNumber >= 0 && randomNumber < 1) {
          computerChoice = 'Bat';
        } else if (randomNumber >= 1 && randomNumber < 2) {
          computerChoice = 'Ball';
        } else {
          computerChoice = 'Stump';
        }

        return computerChoice;
      }

      function getResultMsg(userMove, computerMove) { 
        if (userMove === 'Bat') {
          if (computerMove === 'Ball') {
            return 'You have Won';
          } else if (computerMove === 'Bat') {
            return `It's a Tie`;
          } else {
            return 'Computer has Won';
          }
        } else if (userMove === 'Ball') {
          if (computerMove === 'Stump') {
            return 'You have Won';
          } else if (computerMove === 'Ball') {
            return `It's a Tie`;
          } else {
            return 'Computer has Won';
          }
        } else if (userMove === 'Stump') {
          if (computerMove === 'Bat') {
            return 'You have Won';
          } else if (computerMove === 'Stump') {
            return `It's a Tie`;
          } else {
            return 'Computer has Won';
          }
        }
      }

      function showResult(userMove, computerMove, resultMsg) {
        localStorage.setItem('score', JSON.stringify(score));

        //userMove
        document.querySelector('#user-move').innerText =
        userMove !== undefined ? `You have chosen ${userMove}` : '';

        //ComputerMove
        document.querySelector('#computer-move').innerText = computerMove !== undefined ? `Computer has chosen ${computerMove}` : '';

        //result
        document.querySelector('#result').innerText = resultMsg !== undefined ? resultMsg : '';
        document.querySelector('#score').innerText = score.displayScore();
      }
    </script>
  </body>
</html>
